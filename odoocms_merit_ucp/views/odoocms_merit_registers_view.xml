<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="merit_register_view_form" model="ir.ui.view">
        <field name="name">merit_register_view_form</field>
        <field name="model">odoocms.merit.registers</field>
        <field name="arch" type="xml">
            <form string="Merit Register">
                <header>
                    <button type="object" name="open_merit" string="Open" class="oe_highlight" states='draft'/>

                    <button type="object" name="calculate_merit" states='open' string="Calculate Merit" class="oe_highlight" />
                    <button type="object" name="generate_offer_letter" string="Offer Letter" states='open' class="oe_highlight" />
                    <button type="object" name="submit" string="Submit" class="btn btn-warning" states='open' />
                    <button name="download_report" attrs="{'invisible':[('print_report', '=', False)]}" type="object" string="Print Excel Report" class="btn-success" />
                    <field name="state" widget="statusbar"/>

                    <field name="print_report" invisible='1' />
                    <field name="offer_send" invisible='1' />
                </header>
                <sheet>
                    <widget name="web_ribbon" title="Merit Register" bg_color="bg-success"/>
                    <h3 style="text-align: center;">Merit Register</h3>
                    <group>
                        <group>
                            <field name="name" required="1" attrs="{'readonly':[('state', '==', 'done')]}"/>
                            <field name="ssc_aggregate_percent" attrs="{'readonly':[('state', '==', 'done')]}"/>
                            <field name="bs_aggregate_percent" attrs="{'readonly':[('state', '==', 'done')]}"/>
                            <field name="entry_test_aggregate_percent" attrs="{'readonly':[('state', '==', 'done')]}"/>
                            <field name="interview_aggregate_percent" attrs="{'readonly':[('state', '==', 'done')]}"/>
                        </group>
                        <group>
                            <field name="register_id" required="1" attrs="{'readonly':[('state', '==', 'done')]}"/>
                            <field name="hssc_aggregate_percent" attrs="{'readonly':[('state', '==', 'done')]}"/>
                            <field name="ms_aggregate_percent" attrs="{'readonly':[('state', '==', 'done')]}"/>
                            <field name="register_program_ids" invisible="1"/>
                            <field name="program_id" attrs="{'readonly':[('state', '==', 'done')]}"/>
                            <field name="pre_test_aggregate_percent" invisible="1" attrs="{'readonly':[('state', '==', 'done')]}"/>
                            <field name="minimum_aggregate" required="1" />
                            <field name="waiting_below"  />
                            <field name="minimum_test_percentage"  />
                        </group>
                        <group>
                            <field name="publish_merit" attrs="{'readonly':[('state', '==', 'done')]}"/>
                            <!-- <field name="select_all" attrs="{'readonly':[('state', '==', 'done')]}"/> -->
                            <field name="total_seats" />
                            <field name="remaining_seats" />
                        </group>
                    </group>
                    <notebook>
                      <!--  <page string="Merit Program">
                            <field name="program_ids">
                                <tree editable="bottom">
                                    <field name="program_id"/>
                                </tree>
                            </field>
                        </page>-->
                        <page string="Student Merit List">
                            <field name="merit_lines" attrs="{'readonly':[('state', '==', 'done')]}">
                                <tree decoration-warning="transferred == True" decoration-success='offer_allocated == True' editable="bottom">
                                    <field name="transferred" invisible='1' />
                                    <field name="offer_allocated" invisible='1' />
                                    <field name="applicant_id"/>
                                    <field name="program_id" required="1"/>
                                    <field name="program_id" invisible="1"/>
                                    <field name="merit_no"/>
                                    <field name="matric_marks_per"/>
                                    <field name="inter_marks_per"/>
                                    <field name="entry_test_marks" invisible="1"/>
                                    <field name="bs_cgpa" optional='hide'/>
                                    <field name="ms_cgpa" optional='hide'/>
                                    <!-- <field name="cbt_english"/>
                                    <field name="cbt_math"/>
                                    <field name="cbt_physics"/>
                                    <field name="cbt_chemistry"/>
                                    <field name="cbt_bio"/>
                                    <field name="cbt_analytical"/>
                                    <field name="cbt_rc"/>
                                    <field name="cbt_ew"/> -->
                                    <field name="pre_test_marks"/>
                                    <field name="cbt_percentage"/>
                                    <field name="aggregate"/>
                                    <field name="public_visible" optional='hide'/>
                                    <field name="selected"/>
                                    <field name="waiting"/>
                                    <field name="rejected"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Test Group Aggregate">
                            <field name="merit_agg_ids" attrs="{'readonly':[('state', '==', 'done')]}">
                                <tree editable="bottom">
                                    <!--<field name="program_id"/>-->
                                    <field name="name"/>
                                    <field name="aggregate"/>
                                </tree>
                            </field>
                        </page>
                        <page string='Offer Letter Line'>
                            <field  attrs="{'readonly':[('state', '==', 'done')]}" name="offer_letter_line" />
                        </page>
                        <!--<page string="Pre Test Aggregate">
                            <field name="pre_test_agg_ids" attrs="{'readonly':[('state', '==', 'done')]}">
                                <tree editable="bottom">
                                    <field name="pre_test_id"/>
                                    <field name="aggregate"/>
                                </tree>
                            </field>
                        </page>-->

                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>
    <record id="merit_register_view_tree" model="ir.ui.view">
        <field name="name">merit_register_view_tree</field>
        <field name="model">odoocms.merit.registers</field>
        <field name="arch" type="xml">
            <tree string="Merit Registers">
                <field name="name"/>
                <field name="register_id"/>
            </tree>
        </field>
    </record>
    <record id="merit_register_action" model="ir.actions.act_window">
        <field name="name">Merit Register</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">odoocms.merit.registers</field>
        <field name="view_mode">tree,form</field>
    </record>
    <!-- This Menu Item will appear in the Upper bar, That's why It needs NO parent or action -->
    <menuitem
            id="merit_register_main_menu"
            name="Merit Register"
            parent="odoocms_admission.menu_odoocms_admission_root"
            groups="odoocms_admission.group_admission_manager"
            sequence="35"/>

    <menuitem
            id="merit_register_menu"
            name="Merit Register"
            parent="merit_register_main_menu"
            action="merit_register_action"
            groups="odoocms_admission.group_admission_manager"
            sequence="10"/>
</odoo>
