<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="odoocms_fee_ext.term_fee_challan_template">
            <t t-call="web.basic_layout">
                <t t-if="not company">
                    <t t-if="company_id">
                        <t t-set="company" t-value="company_id"/>
                    </t>
                    <t t-elif="o and 'company_id' in o">
                        <t t-set="company" t-value="o.company_id.sudo()"/>
                    </t>
                    <t t-else="else">
                        <t t-set="company" t-value="res_company"/>
                    </t>
                </t>

                <style>
                    #invoice-info {
                        font-family: Times New Roman,Times,serif, Arial, Helvetica, sans-serif;
                        border-collapse: collapse;
                        width: 100%;
                        margin: 0%;
                    }
                    #invoice-info td, #invoice-info th {
                        border: 1px solid #ddd;
                        padding: 1px, 3px, 1px, 3px;
                    }
                    #invoice-info th {
                        text-align: left;
                        width:60%;
                        font-weight:normal;
                    }
                    #invoice-info td {
                        text-align: right;
                        width:40%;
                    }
                    #invoice-report {
                        font-family: Times New Roman,Times,serif, Arial, Helvetica, sans-serif;
                        border-collapse: collapse;
                        width: 98%;
                        margin: 1.5%;
                    }
                    #invoice-report td, #invoice-report th {
                        border: 1px solid #ddd;
                        padding: 2px;
                    }
                    #invoice-report th {
                        text-align: left;
                        width:60%;
                        font-weight:normal;
                    }
                    #invoice-report td {
                        text-align: right;
                        width:40%;
                    }
                    #invoice-report-student-info {
                        font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
                        border-collapse: collapse;
                        width: 98%;
                        margin: 1.5%;
                    }
                    #invoice-report-student-info td, #invoice-report-student-info th {
                        border: 1px solid #ddd;
                        padding: 3px;
                    }
                    #invoice-report-student-info th {
                        text-align: left;
                        width:40%;
                        font-weight:bold;
                    }
                    #invoice-report-student-info td {
                        text-align: right;
                        width:60%;
                    }
                    .bottom-center {
                        position: absolute;
                        left: 25%;
                        bottom: 0;
                    }
                    .watermark {
                        position: absolute;
                        top: 20%;
                        left: 40%;
                        transform: translate(-50%, -50%);
                        font-size: 100px;
                        color: #ccc;
                        opacity: 0.1;
                        z-index: -1;
                        transform:rotate(200deg);
                        -webkit-transform:rotate(320deg);
                    }
                </style>

                <t t-foreach="docs.sudo()" t-as="doc">
<!--                    <t t-set="fine_policy" t-value="doc.sudo().action_check_fine_policy()"/>-->
                    <div class="page" style="font-size: 10px; padding:0px ">
                        <t t-call="odoocms_fee_ext.receipt_copies_container">
                            <t t-set="move" t-value="doc.line_ids.mapped('move_id')"/>
                            <t t-set="inv" t-value="move[0]"/>
                            <t t-set="paid_amt" t-value="doc.paid_amount"/>
                            <t t-set="adjusted_amt" t-value="inv.get_adjusted_amount()"/>
                            <t t-set="rem_amt" t-value="doc.invoice_remaining_amount"/>
                            <t t-set="fine_amt" t-value="doc.late_fine or 0"/>
                            <t t-set="fine_amt" t-value="fine_amt + doc.fine_amount"/>
<!--                            <t t-if="doc.label_id.code == 'Main'">-->
<!--                                <t t-set="fine_amt" t-value="fine_amt + inv.get_challan_fine_amount()"/>-->
<!--                            </t>-->
                        </t>
                    </div>
                </t>
            </t>
        </template>

        <template id="odoocms_fee_ext.receipt_copies_container">
            <div class="row" style="width:100%;">
                <div style="width:32%; border:1px solid; margin-right:5px">
                    <t t-call="odoocms_fee_ext.receipt_copy">
                        <t t-set="copy_name">Bank Copy</t>
                    </t>
                </div>

                <div style="width:32%; border:1px solid; margin-right:5px">
                    <t t-call="odoocms_fee_ext.receipt_copy">
                        <t t-set="copy_name">University Copy</t>
                    </t>
                </div>

                <div style="width:32%; border:1px solid; margin-right:5px">
                    <t t-call="odoocms_fee_ext.receipt_copy">
                        <t t-set="copy_name">Student Copy</t>
                    </t>
                </div>
            </div>
        </template>

        <template id="odoocms_fee_ext.receipt_header">
            <div class="row">
                <div class="col col-12">
                    <table id="invoice-info" style="margin-top:10px;">
                        <tr style="font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif;">
                            <td style="border: 1px solid #ddd; text-align:center; font-size:12px; font-weight:bold; color: black;padding-top:1px;">
                                <span t-field="inv.company_id.name"/>
                            </td>
                            <td style="border: 1px solid #ddd; text-align:center; font-size:12px; font-weight:bold;">
                                <span t-esc="copy_name"/>
                            </td>
                        </tr>

                        <tr style="font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif;">
                            <td style="border: 1px solid #ddd; text-align:center; font-size:12px; color: black;padding-top:1px;">
                                <t t-if="inv.institute_id">
                                    <span t-field="inv.institute_id.name"/>
                                </t>
                            </td>

                            <td style="border: 1px solid #ddd; text-align:center; font-size:12px; font-weight:bold;">
                                <span t-field="doc.label_id.name"/>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="row">
                <div class="col col-12"
                     style="font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif;border: 0px solid #ddd; text-align:center; font-size:12px; color: black;padding-top:1px;">
                    <t t-esc="doc.student_id.campus_id.fee_banks"/>
                </div>
            </div>
            <div class="row" style="margin-top:5px;" width="100%">
                <div class="col col-1"
                     style="margin-left:2px;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; font-size:9px;font-weight:bold; color: black;">
                    <nobr>Reg #.</nobr>
                </div>
                <div class="col col-3"
                     style="text-decoration: underline;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; font-size:9px; color: black;text-align:left;">
                    <nobr>
                        <span style="text-align:left;" t-esc="doc.student_id.code"/>
                    </nobr>
                </div>

                <div class="col col-1"
                     style="font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; text-align:left; font-size:9px; font-weight:bold; color: black">
                    <nobr>Prog</nobr>
                </div>
                <div class="col col-3"
                     style="text-decoration: underline;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; text-align:left; font-size:9px; color: black">
                    <nobr>
                        <span style="text-align:left;" t-esc="doc.program_id.code"/>
                    </nobr>
                </div>

                <div class="col col-1"
                     style="font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; text-align:left; font-size:9px;font-weight:bold; color: black;">
                    <nobr>Challan</nobr>
                </div>
                <div class="col col-2"
                     style="text-decoration: underline;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; text-align:left; font-size:9px; color: black;">
                    <nobr>
                        <span style="text-align:left;" t-esc="doc.name"/>
                    </nobr>
                </div>
            </div>
            <div class="row" width="100%">
                <div class="col col-1"
                     style="margin-left:2px;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; font-size:9px;font-weight:bold; color: black;">
                    <nobr>Name</nobr>
                </div>
                <div class="col col-10"
                     style="text-decoration: underline;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; font-size:9px; color: black;text-align:left;text-transform: uppercase;">
                    <span style="text-align:left;" t-esc="doc.student_id.name"/>
                </div>
            </div>
            <div class="row" width="100%">
                <div class="col col-1"
                     style="margin-left:2px;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; font-size:9px;font-weight:bold; color: black;">
                    <nobr>CGPA</nobr>
                </div>
                <div class="col col-3"
                     style="text-decoration: underline;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; font-size:9px; color: black;text-align:left;">
                    <nobr>
                        <span style="text-align:left;" t-field="doc.student_id.cgpa"/>
                    </nobr>
                </div>

                <div class="col col-1"
                     style="font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; text-align:left; font-size:9px; font-weight:bold; color: black">
                    <nobr>GPA</nobr>
                </div>
                <div class="col col-3"
                     style="text-decoration: underline;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; text-align:left; font-size:9px; color: black">
                    <nobr>
                        <span style="text-align:left;" t-esc="inv.get_student_pga()"/>
                    </nobr>
                </div>

                <div class="col col-1"
                     style="font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; text-align:left; font-size:9px;font-weight:bold; color: black;">
                    <nobr>Term:</nobr>
                </div>
                <div class="col col-2"
                     style="text-decoration: underline;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; text-align:left; font-size:9px; color: black;">
                    <nobr>
                        <span style="text-align:left;" t-esc="doc.term_id.name"/>
                    </nobr>
                </div>
            </div>
        </template>

        <template id="odoocms_fee_ext.receipt_courses_header">
            <tr style="border:1px solid black;background-color:#7AE7F0">
                <td style="font-weight:bold;text-align:center;border:1px solid black;width:18%;">
                    <span>Course Code</span>
                </td>
                <td style="font-weight:bold;text-align:center;border:1px solid black;width:5%;">
                    <span>CH</span>
                </td>
                <td style="font-weight:bold;text-align:center;width:60%;border:1px solid black;">
                    <span>Course Title</span>
                </td>
                <td style="font-weight:bold;text-align:center;border:1px solid black;width:5%;">
                    <span>Sec.</span>
                </td>
<!--                            <td style="font-weight:bold;text-align:center;border:1px solid black;width:12%;">-->
<!--                                <span>Disc</span>-->
<!--                            </td>-->
                <td style="font-weight:bold;text-align:center;border:1px solid black;width:12%;">
                    <span>Fee</span>
                </td>
            </tr>
        </template>

        <template id="odoocms_fee_ext.receipt_courses_registered">
            <t t-foreach="course_lines" t-as="line">
                <tr style="border:1px solid black;">
                    <td style="text-align:left;padding-left:2px;border:1px solid black;width:18%;">
                        <span t-esc="line['code']"/>
                    </td>

                    <td style="text-align:center;padding-left:2px;border:1px solid black;width:5%;">
                        <span t-esc="line['credits']"/>
                    </td>

                    <td style="text-align:left;width:60%;padding-left:2px;border:1px solid black;">
                        <span t-esc="line['name']"/>
                    </td>

                    <td style="text-align:center;padding-left:2px;border:1px solid black;width:5%;">
                        <span t-esc="line['section']"/>
                    </td>
                    <td style="text-align:right;padding-right:2px;border:1px solid black;width:15%;">
                        <span t-esc="'{0:,.0f}'.format(line['gross'])"/>
                    </td>
                </tr>
            </t>
        </template>

        <template id="odoocms_fee_ext.receipt_courses_unregistered">
            <t t-foreach="move.mapped('invoice_line_ids')" t-as="line">
                <t t-if="not line.fee_head_id.exclude_from_report"> <!-- and line.price_subtotal >= 0 and line.registration_type !='drop' -->
                    <tr style="border:1px solid black;">
                        <!--***** Course Code Line *****-->
                        <td style="text-align:left;padding-left:2px;border:1px solid black;width:18%;">
                            <span t-esc="line.sudo().course_id_new.course_id.code"/>
                        </td>

                        <!--***** Course Credit Hours Line *****-->
                        <td style="text-align:center;padding-left:2px;border:1px solid black;width:5%;">
                            <!-- Aqeel -->
                            <!--                                        <t t-if="line.sudo().course_id_new.course_id and not line.sudo().course_id_new.course_id.name == 'Career Lab' and int(line.sudo().course_id_new.course_id.credits) >= 0">-->
                            <t t-if="line.sudo().course_id_new.course_id and int(line.sudo().course_id_new.course_id.credits) >= 0">
                                <span t-esc="int(line.sudo().course_id_new.course_id.credits)"/>
                            </t>

                        </td>

                        <!--***** Course Name Line ***** -->
                        <td style="text-align:left;width:60%;padding-left:2px;border:1px solid black;">
                            <t t-if="line.sudo().course_id_new.course_id">
                                <span t-esc="line.sudo().course_id_new.course_id.name[:35]"/>
                                <span t-esc="line.sudo().get_move_line_withdraw_repeat_status()"/>
                            </t>
                            <t t-if="not line.sudo().course_id_new.course_id">
                                <span t-esc="line.sudo().name[:35]"/>
                                <span t-esc="line.sudo().get_move_line_withdraw_repeat_status()"/>
                            </t>
                            <t t-if="line.sudo().registration_type=='add'">
                                (Add)
                            </t>
                            <t t-if="line.sudo().registration_type=='drop'">
                                (Drop)
                            </t>
                        </td>

                        <!-- ***** Section Name Line ***** -->
                        <td style="text-align:center;padding-left:2px;border:1px solid black;width:5%;">
                            <span t-esc="line.sudo().course_id_new.section_id and line.sudo().course_id_new.section_id.name or ''"/>
                        </td>
<!--                                    <td style="text-align:center;padding-left:2px;border:1px solid black;width:12%;">-->
<!--                                        <span t-esc="line.sudo().discount and str(line.sudo().discount)+'%' or '-'"/>-->
<!--                                    </td>-->

                        <!--***** Course Gross Fee Line  *****-->
                        <t t-set="line_total" t-value="line.sudo().price_unit * line.sudo().quantity"/>
                        <td style="text-align:right;padding-right:2px;border:1px solid black;width:15%;">
                            <span t-esc="'{0:,.0f}'.format(line_total)"/>
<!--                                        <t t-if="line.sudo().course_gross_fee > 0">-->
<!--                                            <span t-esc="'{0:,.0f}'.format(line.sudo().course_gross_fee)"/>-->
<!--                                        </t>-->
<!--                                        <t t-elif="line.sudo().course_gross_fee == 0">-->
<!--                                            <span t-esc="'{0:,.0f}'.format(line.sudo().price_subtotal)"/>-->
<!--                                        </t>-->
                        </td>
                        <t t-set="total" t-value="total+line_total"/>
                    </tr>
                </t>
            </t>

<!--            <t t-foreach="move.sudo().mapped('line_ids').filtered(lambda l: l.account_internal_type in ('receivable', 'payable')).mapped('matched_credit_ids').mapped('credit_move_id').filtered(lambda m:-->
<!--                    not m.payment_id).mapped('move_id').line_ids.filtered(lambda k: k.course_id_new)" t-as="line">-->
<!--                <t t-if="not line.fee_head_id.exclude_from_report"> &lt;!&ndash; and line.price_subtotal >= 0 and line.registration_type !='drop' &ndash;&gt;-->
<!--                    <tr style="border:1px solid black;">-->
<!--                        &lt;!&ndash;***** Course Code Line *****&ndash;&gt;-->
<!--                        <td style="text-align:left;padding-left:2px;border:1px solid black;width:18%;">-->
<!--                            <span t-esc="line.sudo().course_id_new.course_id.code"/>-->
<!--                        </td>-->

<!--                        &lt;!&ndash;***** Course Credit Hours Line *****&ndash;&gt;-->
<!--                        <td style="text-align:center;padding-left:2px;border:1px solid black;width:5%;">-->
<!--                            &lt;!&ndash; Aqeel &ndash;&gt;-->
<!--                            &lt;!&ndash;                                        <t t-if="line.sudo().course_id_new.course_id and not line.sudo().course_id_new.course_id.name == 'Career Lab' and int(line.sudo().course_id_new.course_id.credits) >= 0">&ndash;&gt;-->
<!--                            <t t-if="line.sudo().course_id_new.course_id and int(line.sudo().course_id_new.course_id.credits) >= 0">-->
<!--                                <span t-esc="int(line.sudo().course_id_new.course_id.credits)"/>-->
<!--                            </t>-->

<!--                        </td>-->

<!--                        &lt;!&ndash;***** Course Name Line ***** &ndash;&gt;-->
<!--                        <td style="text-align:left;width:60%;padding-left:2px;border:1px solid black;">-->
<!--                            <t t-if="line.sudo().course_id_new.course_id">-->
<!--                                <span t-esc="line.sudo().course_id_new.course_id.name[:35]"/>-->
<!--                                <span t-esc="line.sudo().get_move_line_withdraw_repeat_status()"/>-->
<!--                            </t>-->
<!--                            <t t-if="not line.sudo().course_id_new.course_id">-->
<!--                                <span t-esc="line.sudo().name[:35]"/>-->
<!--                                <span t-esc="line.sudo().get_move_line_withdraw_repeat_status()"/>-->
<!--                            </t>-->
<!--                            <t t-if="line.sudo().registration_type=='add'">-->
<!--                                (Add)-->
<!--                            </t>-->
<!--                            <t t-if="line.sudo().registration_type=='drop'">-->
<!--                                (Drop)-->
<!--                            </t>-->
<!--                        </td>-->

<!--                        &lt;!&ndash; ***** Section Name Line ***** &ndash;&gt;-->
<!--                        <td style="text-align:center;padding-left:2px;border:1px solid black;width:5%;">-->
<!--                            <span t-esc="line.sudo().course_id_new.section_id and line.sudo().course_id_new.section_id.name or ''"/>-->
<!--                        </td>-->
<!--&lt;!&ndash;                                    <td style="text-align:center;padding-left:2px;border:1px solid black;width:12%;">&ndash;&gt;-->
<!--&lt;!&ndash;                                        <span t-esc="line.sudo().discount and str(line.sudo().discount)+'%' or '-'"/>&ndash;&gt;-->
<!--&lt;!&ndash;                                    </td>&ndash;&gt;-->

<!--                        &lt;!&ndash;***** Course Gross Fee Line  *****&ndash;&gt;-->
<!--&lt;!&ndash;                                    <t t-set="line_total" t-value="line.sudo().price_unit * line.sudo().quantity"/>&ndash;&gt;-->
<!--                        <td style="text-align:right;padding-right:2px;border:1px solid black;width:15%;">-->
<!--&lt;!&ndash;                                        <span t-esc="'{0:,.0f}'.format(line_total)"/>&ndash;&gt;-->
<!--&lt;!&ndash;                                        <t t-if="line.sudo().course_gross_fee > 0">&ndash;&gt;-->
<!--&lt;!&ndash;                                            <span t-esc="'{0:,.0f}'.format(line.sudo().course_gross_fee)"/>&ndash;&gt;-->
<!--&lt;!&ndash;                                        </t>&ndash;&gt;-->
<!--&lt;!&ndash;                                        <t t-elif="line.sudo().course_gross_fee == 0">&ndash;&gt;-->
<!--&lt;!&ndash;                                            <span t-esc="'{0:,.0f}'.format(line.sudo().price_subtotal)"/>&ndash;&gt;-->
<!--&lt;!&ndash;                                        </t>&ndash;&gt;-->
<!--                        </td>-->
<!--&lt;!&ndash;                                    <t t-set="total" t-value="total+line_total"/>&ndash;&gt;-->
<!--                    </tr>-->
<!--                </t>-->
<!--            </t>-->

        </template>

        <template id="odoocms_fee_ext.receipt_courses">
            <div class="row">
                <div class="col col-12">
                    <table id="invoice-report" style="margin-top:10px;">
                        <t t-call="odoocms_fee_ext.receipt_courses_header"/>
                        <t t-if="challan_type in ('main', 'installment','add_drop')">
                            <t t-call="odoocms_fee_ext.receipt_courses_registered"/>
                        </t>
                        <!--*****  Invoice Lines *****-->
<!--                        <t t-set="total" t-value="0"/>-->

                        <!--*****  Dropped Courses Invoice Lines *****-->
<!--                        <t t-if="inv.challan_type =='add_drop'">-->
<!--                            <t t-foreach="doc.sudo().line_ids.filtered(lambda a:a.registration_type=='drop' and 'Paid' in a.name)"-->
<!--                               t-as="line">-->
<!--                                <tr style="border:1px solid black;">-->
<!--                                    &lt;!&ndash;***** Course Code Line *****&ndash;&gt;-->
<!--                                    <td style="text-align:left;padding-left:2px;border:1px solid black;width:20%;">-->
<!--                                        <span t-esc="line.sudo().course_id_new.course_id.code"/>-->
<!--                                    </td>-->

<!--                                    &lt;!&ndash;***** Course Credit Hours Line *****&ndash;&gt;-->
<!--                                    <td style="text-align:center;padding-left:2px;border:1px solid black;width:6%;">-->
<!--                                        <t t-if="line.sudo().course_id_new.course_id and not line.sudo().course_id_new.course_id.name == 'Career Lab' and int(line.sudo().course_id_new.course_id.credits) > 0">-->
<!--                                            <span t-esc="int(line.sudo().course_id_new.course_id.credits)"/>-->
<!--                                        </t>-->

<!--                                    </td>-->

<!--                                    &lt;!&ndash;***** Course Name Line ***** &ndash;&gt;-->
<!--                                    <td style="text-align:left;width:60%;padding-left:2px;border:1px solid black;">-->
<!--                                        <t t-if="line.sudo().course_id_new.course_id">-->
<!--                                            <span t-esc="line.sudo().course_id_new.course_id.name[:35]"/>-->
<!--                                        </t>-->
<!--                                        <t t-if="not line.sudo().course_id_new.course_id">-->
<!--                                            <span t-esc="line.sudo().name[:35]"/>-->
<!--                                        </t>-->
<!--                                        (Drop)-->
<!--                                    </td>-->

<!--                                    &lt;!&ndash; ***** Section Name Line ***** &ndash;&gt;-->
<!--                                    <td style="text-align:center;padding-left:2px;border:1px solid black;width:10%;">-->
<!--                                        <span t-esc="line.sudo().course_id_new.section_name"/>-->
<!--                                    </td>-->

<!--                                    &lt;!&ndash;***** Course Gross Fee Line  *****&ndash;&gt;-->
<!--                                    <td style="text-align:right;padding-right:2px;border:1px solid black;width:10%;">-->
<!--                                        <span t-esc="'{0:,.0f}'.format(line.sudo().course_gross_fee)"/>-->
<!--                                    </td>-->
<!--                                </tr>-->
<!--                            </t>-->
<!--                        </t>-->

                        <tr style="border:1px solid black;">
                            <td colspan="3"
                                style="font-weight:bold;border:1px solid black;text-align:right;padding-right:5px;">
                                Gross Tuition Fee..
                            </td>
                            <td colspan="2"
                                style="font-weight:bold;border:1px solid black;padding-right:5px;background-color:#7AE7F0">
                                <span t-esc="'{0:,.0f}'.format(gross)"/>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </template>

        <template id="odoocms_fee_ext.receipt_summary">
            <div class="row">
                <div class="col col-12">
                    <table id="invoice-report">

                        <!--***** Paid Water Mark *****-->
                        <t t-if="doc.state == 'paid'">
                            <div class="watermark">Paid</div>
                        </t>

                        <!-- ***** Scholarship Name ***** -->
                        <tr style="border:1px solid black;">
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Scholarship Type</span>
                            </td>
                            <td style="font-size:10px;text-align:right;border:1px solid black;">
                                <t t-foreach="inv.waiver_ids" t-as="wavier">
                                    <span t-esc="wavier.scholarship_category_id and wavier.scholarship_category_id.name or ''"/>
                                    <t t-if="len(inv.waiver_ids) > 1">
                                        <span>,</span>
                                    </t>
                                </t>
                            </td>
                        </tr>

                        <!--***** Scholarship Percentage *****-->
                        <tr>
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>On Tuition Fee</span>
                            </td>
                            <td style="font-size:10px;border:1px solid black;">
                                <!--                                <span t-esc="doc.waiver_amount"/>-->
                                <t t-if="inv.scholarship_continue_policy_line_id.value > 0">
                                    <span t-esc="'{0:,.2f}'.format(inv.scholarship_continue_policy_line_id.value)"/>%
                                </t>
                                <t t-elif="inv.waiver_percentage >0">
                                    <span t-esc="'{0:,.2f}'.format(inv.waiver_percentage)"/>%
                                </t>
                            </td>
                        </tr>

                        <!--***** Scholarship Amount *****-->
                        <tr>
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Less Scholarship Amount</span>
                            </td>
                            <td style="font-size:10px;border:1px solid black;">
                                <t t-if="inv.waiver_amount > 0">
                                    (<span t-esc="'{0:,.0f}'.format(inv.waiver_amount)"/>)
                                </t>
                            </td>
                        </tr>

                        <!--***** Semester Total Fee *****-->
                        <tr>
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Total Semester Fee</span>
                            </td>
                            <td style="font-size:10px;border:1px solid black;">
                                <t t-if="inv.semester_gross_fee - inv.waiver_amount > 0">
                                    <span t-esc="'{0:,.0f}'.format(inv.semester_gross_fee +  - inv.waiver_amount)"/>
                                </t>
                            </td>
                        </tr>

                        <!--***** OD *****-->
                        <tr>
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Less Previously Paid (over draft)</span>
                            </td>

                            <td style="font-size:10px;border:1px solid black;">
                                <span t-esc="'{0:,.0f}'.format(abs(inv.get_previously_paid_invoice()))"/>
                            </td>
                        </tr>

                        <!--***** Semester Gross Fee *****-->
                        <tr>
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Total Payable Semester Fee</span>
                            </td>
                            <td style="font-size:10px;border:1px solid black;">
                                <t t-if="inv.semester_gross_fee > 0">
                                    <span t-esc="'{0:,.0f}'.format(inv.semester_gross_fee - inv.waiver_amount)"/>
                                </t>
                            </td>
                        </tr>

                        <!--***** Current Installment Amount  *****-->
                        <tr style="border:1px solid black;">
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Installment (Paid)</span>
                            </td>
                            <td style="font-size:10px; border:1px solid black;">
                                <t t-if="paid_amt > 0">
                                    <span t-esc="'{0:,.0f}'.format(paid_amt)"/>
                                </t>
                            </td>
                        </tr>

                        <tr t-if="adjusted_amt > 0" style="border:1px solid black;">
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Installment (Adjusted)</span>
                            </td>
                            <td style="font-size:10px; border:1px solid black;">
                                <span t-esc="'{0:,.0f}'.format(adjusted_amt)"/>
                            </td>
                        </tr>

                        <!--***** Remaining Fee *****-->
                        <tr style="border:1px solid black;">
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Remaining Fee (
                                    <span t-if="rem_amt > 0" t-esc="doc.invoice_remaining_due_date"/>
                                    )
                                </span>
                            </td>
                            <td style="border:1px solid black;">
                                <t t-if="not inv.challan_type == 'add_drop' and rem_amt > 0">
                                    <span t-esc="'{0:,.0f}'.format(rem_amt)"/>
                                </t>
                            </td>
                        </tr>

                        <!--***** Payable Fine *****-->
                        <tr style="border:1px solid black;">
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Payable Fine</span>
                            </td>
                            <td style="font-size:10px;text-align:right;border:1px solid black;">
                                <span t-esc="'{0:,.0f}'.format(fine_amt)"/>
                            </td>
                        </tr>

                        <tr t-if="doc.student_id.session_id.id != 198" style="border:1px solid black;">
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Total Semester Charges</span>
                            </td>
                            <td style="font-size:10px;border:1px solid black;">
                                <span t-esc="'{0:,.0f}'.format(inv.semester_gross_fee - inv.waiver_amount)"/>
                            </td>
                        </tr>

                        <tr t-if="doc.discount > 0">
                            <td style="font-size:10px;text-align:left;width:70%;border:1px solid black;">
                                <span>Less Payment Discount</span>
                            </td>
                            <td style="font-size:10px;border:1px solid black;">
                                    (<span t-esc="'{0:,.0f}'.format(doc.discount)"/>)

                            </td>
                        </tr>

                    </table>
                </div>
            </div>

            <!-- Instructions Div -->
            <div class="row">
                <div class="col col-12">
                    <t t-raw="doc.student_id.campus_id.fee_instructions"/>
                </div>
            </div>
        </template>

        <template id="odoocms_fee_ext.receipt_footer">
            <div class="row" width="100%" style="margin-top:2px;">
                <div class="col col-12">
                    <table id="invoice-report" style="margin-top:10px;">
                        <tr style="text-align:left;font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; font-size:12px;font-weight:bold; color: black;border:1px solid black;">
                            <td style="text-align:center;border:1px solid black;width:50%;">
                                <img t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s&amp;' % ('Code128',doc.name, 500, 100)" style="width:250px;height:29px;"/>
                            </td>
                            <td rowspan="3"
                                style="text-align:center;border:1px solid black; justify-content: center;align-items: center;display: flex;width:50%;">
                                Bank Stamp
                            </td>
                        </tr>

                        <t t-set="amount_residual" t-value="doc.roundhalfup(doc.amount_residual)"/>
                        <tr style="font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; font-size:10px;font-weight:bold; color: black;border:1px solid black;">
                            <td style="text-align:center;border:1px solid black;width:50%;">
                                Payable Amount
                                <p style="text-align:center;font-size:15px;margin:0px;">
                                    Rs.
                                    <t t-esc="'{0:,.0f}'.format(amount_residual)"/>/-

                                    <p style="font-size:8px;padding-top:0px;">
                                        (<t t-esc="inv.currency_id.amount_to_text(int(amount_residual))"/> Only)
                                    </p>
                                </p>

                            </td>
                        </tr>

                        <tr style="font-family:Times New Roman,Times,serif, Arial, Helvetica, sans-serif; font-size:9px;color: black;border:1px solid black;">
                            <td style="text-align:left;border:1px solid black;width:50%;">
                                Expiry Date:&#160;&#160;&#160;&#160;&#160;&#160;
                                <span t-esc="doc.date_due.strftime('%d-%b-%Y')"/>
                                <br/>
                                Printed On: &#160;&#160;&#160;&#160;&#160;&#160;
                                <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d-%b-%Y %H:%M')"/>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </template>

        <template id="odoocms_fee_ext.receipt_copy">
            <t t-call="odoocms_fee_ext.receipt_header"/>
            <t t-call="odoocms_fee_ext.receipt_courses"/>
            <t t-call="odoocms_fee_ext.receipt_summary"/>
            <t t-call="odoocms_fee_ext.receipt_footer"/>
        </template>


    </data>
</odoo>
