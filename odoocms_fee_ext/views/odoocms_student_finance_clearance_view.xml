<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="view_odoocms_student_finance_clearance_form" model="ir.ui.view">
            <field name="name">odoocms.student.finance.clearance.form</field>
            <field name="model">odoocms.student.finance.clearance</field>
            <field name="arch" type="xml">
                <form string="Student Finance Clearance">
                    <header>
                        <button name="action_get_detail" states="draft" string="Get Detail" type="object" class="oe_highlight" groups="account.group_account_manager"/>
                        <button name="action_done" states="draft" string="Confirm Clearance" type="object" class="oe_highlight" groups="account.group_account_manager"/>
                        <button name="action_cancel" states="draft" string="Cancel" type="object" class="oe_highlight" groups="account.group_account_manager"/>
                        <field name="state" widget="statusbar"/>
                    </header>
                    <sheet>
                        <div class="alert alert-warning mb-0" role="alert" attrs="{'invisible': [('warning_message', '=', False)]}">
                            <field name="warning_message" nolabel="1"/>
                        </div>
                        <group>
                            <group>
                                <field name="student_id" required="1" attrs="{'readonly':[('state','!=', 'draft')]}"
                                       options="{'no_quick_create':True,'no_create_edit':True,'no_create':True,}"/>
                                <field name="session_id"/>
                                <field name="career_id"/>
                                <field name="institute_id"/>
                                <field name="batch_id"/>
                            </group>
                            <group>
                                <field name="notification_email" readonly="1"/>
                                <field name="sms_mobile" readonly="1"/>
                                <field name="cgpa" readonly="1"/>
                                <field name="earned_credits" readonly="1"/>
                                <field name="accepted_credits" readonly="1"/>
                            </group>
                            <group>
                                <field name="date" attrs="{'readonly':[('state','!=', 'draft')]}"/>
                                <field name="clearance_date" attrs="{'readonly':[('state','!=', 'draft')]}"/>
                                <field name="amount" attrs="{'readonly':[('state','!=', 'draft')]}"/>
                            </group>
                            <group>
                                <field name="move_id" readonly="1" context="{'form_view_ref': 'odoocms_fee.odoocms_receipt_form'}"/>
                                <field name="challan_id" readonly="1"/>
                            </group>
                        </group>

                        <separator string="Unpaid Challans" style="font-size:16px;color:#20b2aa"/>
                        <hr style="border: 1px solid gray;"/>
                        <button string="View Unpaid Challans" name="action_view_student_semester_unpaid_challan" type="object" icon="fa-thumbs-up"/>


                        <separator string="Tuition Fee" style="font-size:16px;color:#20b2aa"/>
                        <hr style="border: 1px solid gray;"/>
                        <button string="View Challan History" name="action_view_student_semester_challan" type="object" icon="fa-thumbs-up"/>
                        <group>
                            <group>
                                <field name="total_fee" string="Total" readonly="1"/>
                                <field name="fee_scholarship_amount" string="Discount" readonly="1"/>
                            </group>
                            <group>
                                <field name="paid_fee" string="Paid" readonly="1"/>
                                <field name="unpaid_fee" string="Due" readonly="1"/>
                            </group>
                        </group>


                        <separator string="Hostel Fee" style="font-size:16px;color:#20b2aa"/>
                        <hr style="border: 1px solid gray;"/>
                        <button string="View Hostel Challan History" name="action_view_student_hostel_challan" type="object" icon="fa-thumbs-up"/>
                        <group>
                            <group>
                                <field name="total_hostel_fee" string="Total" readonly="1"/>
                                <field name="hostel_fee_scholarship_amount" string="Discount" readonly="1"/>
                            </group>
                            <group>
                                <field name="paid_hostel_fee" string="Paid" readonly="1"/>
                                <field name="unpaid_hostel_fee" string="Due" readonly="1"/>
                            </group>
                        </group>


                        <separator string="Attendance Fine" style="font-size:16px;color:#20b2aa"/>
                        <hr style="border: 1px solid gray;"/>
                        <button string="View Attendance Fine History" name="action_view_attendance_fine_history" type="object" icon="fa-thumbs-up"/>
                        <group>
                            <group>
                                <field name="total_att_fine" string="Total" readonly="1"/>
                                <field name="att_fine_scholarship_amount" string="Discount" readonly="1"/>
                                <button string="Generate Challan" name="action_create_attendance_challan" type="object" icon="fa-thumbs-up" attrs="{'invisible':[('unpaid_att_fine','=',0)]}"/>
                            </group>
                            <group>
                                <field name="paid_att_fine" string="Paid" readonly="1"/>
                                <field name="invoiced_att_fine" string="Invoiced" readonly="1"/>
                                <field name="unpaid_att_fine" string="Due" readonly="1"/>
                            </group>

                            <group style="margin-top:10px;" attrs="{'invisible':[('unpaid_att_fine', '=', 0)]}">
                                <field name="attendance_fine_issue" string="Attendance Issue"
                                       attrs="{'invisible':[('unpaid_att_fine', '=', 0)]}"/>

                            </group>
                        </group>


                        <separator string=" Late Fee Fine" style="font-size:16px;color:#20b2aa"/>
                        <hr style="border: 1px solid gray;"/>
                        <button string="View Late Fee Fine History" name="action_view_late_fee_fine_history" type="object" icon="fa-thumbs-up"/>
                        <group>
                            <group>
                                <field name="total_late_fee_fine" string="Total" readonly="1"/>
                                <field name="late_fee_fine_scholarship_amount" string="Discount" readonly="1"/>
                            </group>
                            <group>
                                <field name="paid_late_fee_fine" string="Paid" readonly="1"/>
                                <field name="unpaid_late_fee_fine" string="Due" readonly="1"/>
                            </group>
                        </group>

                        <separator string="Other Fine" style="font-size:16px;color:#20b2aa"/>
                        <hr style="border: 1px solid gray;"/>
                        <button string="View Other Fine History" name="action_view_other_fine_history" type="object" icon="fa-thumbs-up"/>
                        <group>
                            <group>
                                <field name="total_other_fine" string="Total" readonly="1"/>
                                <field name="other_fine_scholarship_amount" string="Discount" readonly="1"/>
                            </group>
                            <group>
                                <field name="paid_other_fine" string="Paid" readonly="1"/>
                                <field name="unpaid_other_fine" string="Due" readonly="1"/>
                            </group>
                        </group>

                        <separator string="Library Fine" style="font-size:16px;color:#20b2aa"/>
                        <hr style="border: 1px solid gray;"/>
                        <button string="View Library Fine History" name="action_view_library_fine_history" type="object" icon="fa-thumbs-up"/>

                        <group>
                            <group>
                                <field name="total_library_fine" string="Total" readonly="1"/>
                                <field name="library_fine_scholarship_amount" string="Discount" readonly="1"/>
                            </group>
                            <group>
                                <field name="paid_library_fine" string="Total" readonly="1"/>
                                <field name="unpaid_library_fine" string="Due" readonly="1"/>
                            </group>
                        </group>

                        <separator string="Refundable Books" style="font-size:16px;color:#20b2aa"/>
                        <hr style="border: 1px solid gray;"/>
                        <field name="refundable_library_books"/>

                        <separator string="Notes/Remarks" style="font-size:16px;color:#20b2aa"/>
                        <hr style="border: 1px solid gray;"/>
                        <group>
                            <field name="notes" nolabel="1" attrs="{'readonly':[('state','!=', 'draft')]}"/>
                        </group>

                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <!--***** Tree View  *****-->
        <record id="view_odoocms_student_finance_clearance_tree" model="ir.ui.view">
            <field name="name">odoocms.student.finance.clearance.tree</field>
            <field name="model">odoocms.student.finance.clearance</field>
            <field name="arch" type="xml">
                <tree string="Student Finance Clearance" decoration-success="state != 'cancel'">
                    <field name="sequence" widget="handle"/>
                    <field name="name"/>
                    <field name="notification_email" optional="hide"/>
                    <field name="sms_mobile" optional="hide"/>
                    <field name="session_id"/>
                    <field name="career_id"/>
                    <field name="institute_id" optional="show"/>
                    <field name="program_id" optional="show"/>
                    <field name="batch_id" optional="hide"/>
                    <field name="earned_credits" optional="show"/>
                    <field name="accepted_credits" optional="show"/>
                    <field name="cgpa" optional="show"/>
                    <field name="date" optional="show"/>
                    <field name="clearance_date" optional="show"/>
                    <field name="amount" optional="show"/>
                    <field name="company_id" optional="hide" groups="base.group_multi_company"/>
                    <field name="state" widget="badge" decoration-primary="state=='draft'" decoration-success="state=='charged'" decoration-danger="state=='cancel'"/>
                    <field name="create_uid" string="Created By" optional="hide" widget="many2one_avatar_user"/>
                </tree>
            </field>
        </record>

        <!--***** Search View  *****-->
        <record id="view_odoocms_student_finance_clearance_search" model="ir.ui.view">
            <field name="name">odoocms.student.finance.clearance.search</field>
            <field name="model">odoocms.student.finance.clearance</field>
            <field name="arch" type="xml">
                <search string="Student Finance Clearance">
                    <field name="student_id"/>
                    <field name="sms_mobile"/>
                    <field name="session_id"/>
                    <field name="career_id"/>
                    <field name="institute_id"/>
                    <field name="discipline_id"/>
                    <field name="campus_id"/>
                    <field name="date"/>
                    <field name="clearance_date"/>
                    <field name="amount"/>
                    <field name="state"/>
                    <separator/>
                    <filter name="applied_date" string="Applied Date" date="date"/>
                    <filter name="clearance_date" string="Clearance Date" date="clearance_date"/>

                    <group expand="0" string="Group By...">
                        <filter name="group_by_status" string="Status" domain="[]" context="{'group_by':'state'}"/>
                        <filter name="group_by_student" string="Student" domain="[]" context="{'group_by':'student_id'}"/>
                        <filter name="group_by_session" string="Session" domain="[]" context="{'group_by':'session_id'}"/>
                        <filter name="group_career" string="Career" domain="[]" context="{'group_by':'career_id'}"/>
                        <filter name="group_institute" string="Institute" domain="[]" context="{'group_by':'institute_id'}"/>
                        <filter name="group_by_date" string="Date" domain="[]" context="{'group_by':'date'}"/>
                        <filter name="group_by_date" string="Clearance Date" domain="[]" context="{'group_by':'clearance_date'}"/>
                        <filter name="group_by_company" string="Company" domain="[]" context="{'group_by':'company_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!--***** Kanban View *****-->
        <record id="view_odoocms_student_finance_clearance_kanban" model="ir.ui.view">
            <field name="name">odoocms.student.finance.clearance.kanban.view</field>
            <field name="model">odoocms.student.finance.clearance</field>
            <field name="priority">10</field>
            <field name="arch" type="xml">
                <kanban class="o_hr_employee_kanban" js_class="hr_employee_kanban" sample="1">
                    <field name="id"/>
                    <field name="sms_mobile"/>
                    <field name="student_image"/>
                    <field name="session_id"/>
                    <field name="career_id"/>
                    <field name="institute_id"/>
                    <field name="program_id"/>
                    <field name="batch_id"/>
                    <field name="date"/>
                    <field name="amount"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_global_click o_kanban_record_has_image_fill o_hr_kanban_record">
                                <field name="student_image" widget="image" class="o_kanban_image_fill_left" options="{'zoom': true, 'zoom_delay': 1000, 'background': true, 'preventClicks': false}"/>
                                <div class="oe_kanban_details">
                                    <div class="o_kanban_record_top">
                                        <div class="o_kanban_record_headings">
                                            <strong class="o_kanban_record_title">
                                                <field name="student_id" placeholder="Name"/>
                                            </strong>
                                            <span t-if="record.code.raw_value" class="o_kanban_record_subtitle">
                                                <field name="code"/>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="oe_kanban_details">
                                        <span t-if="record.cgpa.raw_value" class="o_kanban_record_subtitle">
                                            <field name="cgpa"/>
                                        </span>
                                        <span t-if="record.session_id.raw_value" class="o_kanban_record_subtitle">
                                            <field name="session_id"/>
                                        </span>
                                        <ul>
                                            <li t-if="record.sms_mobile.raw_value">
                                                <i class="fa fa-phone" role="img" aria-label="Phone" title="Phone"/>
                                                <field name="sms_mobile"/>
                                            </li>
                                            <li t-if="record.notification_email.raw_value">
                                                <i class="fa fa-envelope" role="img" aria-label="Email" title="Email"/>
                                                <a t-attf-href="mailto:#{record.notification_email.value}">
                                                    <field name="notification_email"/>
                                                </a>
                                            </li>
                                        </ul>
                                        <span t-if="record.state.raw_value" class="o_kanban_record_subtitle">
                                            <field name="state"/>
                                        </span>
                                    </div>

                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!--***** Pivot View *****-->
        <record id="view_odoocms_student_finance_clearance_pivot_view" model="ir.ui.view">
            <field name="name">odoocms.student.finance.clearance.pivot.view</field>
            <field name="model">odoocms.student.finance.clearance</field>
            <field name="arch" type="xml">
                <pivot string="Student Finance Clearance Analysis" display_quantity="true">
                    <field name="session_id" type="row"/>
                    <field name="institute_id" type="col"/>
                    <field name="program_id" type="col"/>
                    <field name="date" interval="month" type="col"/>
                </pivot>
            </field>
        </record>

        <!--***** Graph View *****-->
        <record id="view_odoocms_student_finance_clearance_graph_view" model="ir.ui.view">
            <field name="name">view.odoocms.student.finance.clearance.graph</field>
            <field name="model">odoocms.student.finance.clearance</field>
            <field name="arch" type="xml">
                <graph string="Student Finance Clearance Analysis">
                    <field name="session_id" type="row"/>
                    <field name="institute_id" type="col"/>
                    <field name="program_id" type="col"/>
                    <field name="date" interval="month" type="col"/>
                </graph>
            </field>
        </record>


        <!--***** Action *****-->
        <record id="action_odoocms_student_finance_clearance" model="ir.actions.act_window">
            <field name="name">Student Finance Clearance</field>
            <field name="res_model">odoocms.student.finance.clearance</field>
            <field name="view_mode">kanban,tree,form,pivot,graph</field>
        </record>

        <!-- Main Menu -->
        <menuitem
                id="menu_odoocms_student_finance_clearance_main"
                parent="odoocms_fee.menu_odoocms_fee_root"
                name="Clearance"
                groups="group_odoo_finance_clearance_user"
                sequence="65"/>

        <!--***** Menu *****-->
        <menuitem
                id="menu_odoocms_student_finance_clearance"
                name="Student Finance Clearance"
                parent="menu_odoocms_student_finance_clearance_main"
                action="action_odoocms_student_finance_clearance"
                groups="group_odoo_finance_clearance_user"
                sequence="10"
        />

    </data>
</odoo>
