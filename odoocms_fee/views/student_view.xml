<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="view_odoocms_student_form_inherit2" model="ir.ui.view">
            <field name="name">odoocms.student.form.inherit2</field>
            <field name="model">odoocms.student</field>
            <field name="inherit_id" ref="odoocms.view_odoocms_student_form"/>
            <field name="arch" type="xml">
                <xpath expr="//notebook/page[@name='academic_information']" position="after">
                    <page string="Fee Receipts" name="fee_receipts"
                          groups="odoocms.group_cms_manager,odoocms_fee.group_fee_manager,odoocms_fee.group_fee_coordinator,odoocms_fee.group_fee_readonly_user">
                        <group>
                            <group>
                                <field name="fee_structure_id"/>
                            </group>
                            <group></group>
                        </group>
                        <group string="Receipts" name="fee_receipts_group">

                            <field name="receipt_ids" nolabel="1" default_order="id"
                                   context="{
                                    'form_view_ref' : 'odoocms_fee.odoocms_receipt_form',
                                }">
                                <tree edit="false" create="false" delete="false" limit="10"
                                      decoration-info="is_hostel_fee==True"
                                      decoration-success="is_hostel_fee !=True">

                                    <field name="partner_id" groups="base.group_user" invisible="1"/>
                                    <field name="student_id" optional="hide"/>
                                    <field name="name"/>
                                    <field name="barcode"/>
                                    <field name="journal_id" optional="hide"/>

                                    <field name="invoice_date" string="Invoice Date"/>
                                    <field name="invoice_date_due"/>
                                    <field name="payment_date"/>
                                    <field name="term_id" invisible="1"/>
                                    <field name="term_code" string="Term" optional="show"/>

                                    <field name="amount_total_signed" string="Total" sum="Total"/>
                                    <field name="amount_residual_signed" invisible="1" string="Amount Due"
                                           sum="Amount Due"/>
                                    <field name="receipt_type_ids" widget="many2many_tags"/>

                                    <field name="tag" optional="1"/>
                                    <field name="state"/>
                                    <field name="payment_state" optional="show"/>
                                    <field name="is_hostel_fee" invisible="1"/>
                                    <field name="is_fee" invisible="1"/>
                                    <field name="cancel_due_to_arrears" invisible="1"/>
                                </tree>
                            </field>
                        </group>
                         <group string="Receipt Lines" name="fee_receipts_group">
                            <field name="receipt_line_ids" nolabel="1" default_order="id"
                                   context="{
                                    'form_view_ref' : 'odoocms_fee.odoocms_receipt_line_form',
                                }">
                                <tree edit="false" create="false" delete="false" limit="10" default_order='date desc'
                                      decoration-success="reconciled == True">
                                    <field name="challan_no"/>
                                    <field name="name"/>
                                    <field name="date" string="Invoice Date"/>
                                    <field name="date_maturity"/>
                                    <field name="term_id"/>

                                    <field name="debit" optional="hide"/>
                                    <field name="credit" optional="hide"/>
                                    <field name="balance" string="Amount"/>
                                    <field name="installment"/>
                                    <field name="payment_date"/>
                                    <field name="amount_residual"/>
                                    <field name="matching_number"/>
                                    <field name="reconciled" optional="hide"/>

                                </tree>
                            </field>
                        </group>
                        <group string="Ledger" name="fee_ledger_group">
                            <field name="ledger_lines" nolabel="1">
                                <tree edit="false" create="false" delete="false" limit="10"
                                      decoration-warning="ledger_entry_type == 'hostel'"
                                      decoration-primary="ledger_entry_type== 'semester' and payment_id"
                                      decoration-success="ledger_entry_type== 'semester'"
                                >
                                    <field name="sequence" widget="handle" invisible="1"/>
                                    <field name="date"/>
                                    <field name="term_code" string="Term" optional="show"/>
                                    <field name="invoice_id" context="{'form_view_ref': 'odoocms_fee.odoocms_receipt_form'}"/>
                                    <field name="slip_barcode"/>
                                    <field name="payment_id"/>
                                    <field name="description"/>
                                    <field name="ledger_entry_type" optional="hide"/>
                                    <field name="is_defer_entry" optional="hide"/>
                                    <field name="debit" sum="sum_debit"/>
                                    <field name="credit" sum="sum_credit"/>
                                    <field name="balance_str" string="Balance"/>
                                </tree>
                            </field>
                        </group>

                        <group string="Scholarship/Waiver" name="fee_scholarship_group">
                            <field name="waiver_line_ids" nolabel="1">
                                <tree edit="false" create="false" delete="false" decoration-success="amount > 0" limit="10">
                                    <field name="name"/>
                                    <field name="term_id" string="Academic Term" optional="hide"/>
                                    <field name="term_code" string="Term" optional="show"/>
                                    <field name="semester_id" optional="hide"/>
                                    <field name="waiver_line_id" optional="hide"/>
                                    <field name="waiver_type"/>
                                    <field name="invoice_id"/>
                                    <field name="amount_percentage" string="Value" optional="hide"/>
                                    <field name="amount" sum="sum_amount"/>
                                </tree>
                            </field>
                        </group>
                    </page>

                    <page string="Refund Requests" name="fee_refund"
                          groups="odoocms_fee.group_fee_coordinator,odoocms_fee.group_fee_manager">
                        <group>
                            <field name="refund_request_ids" nolabel="1"
                                   groups="odoocms_fee.group_fee_coordinator,odoocms_fee.group_fee_manager">
                                <tree edit="false" create="false" delete="false">
                                    <field name="student_id"/>
                                    <field name="description"/>
                                    <field name="refund_type"/>
                                    <field name="state" readonly="1"/>
                                </tree>
                            </field>
                        </group>
                    </page>
                </xpath>
            </field>
        </record>

        <record id="view_odoocms_student_tree_inherit2" model="ir.ui.view">
            <field name="name">odoocms.student.tree.inherit2</field>
            <field name="model">odoocms.student</field>
            <field name="inherit_id" ref="odoocms.view_odoocms_student_tree"/>
            <field name="arch" type="xml">
                <field name="tag_ids" position="after">
                    <field name="fee_structure_id"/>
<!--                    <field name="fee_generated" optional="hide"/>-->
<!--                    <field name="student_ledger_balance" optional="hide"/>-->
                </field>
            </field>
        </record>

        <record id="view_odoocms_student_search_inherit2" model="ir.ui.view">
            <field name="name">odoocms.student.search.inherit2</field>
            <field name="model">odoocms.student</field>
            <field name="inherit_id" ref="odoocms.view_odoocms_student_search"/>
            <field name="arch" type="xml">
                <field name="religion_id" position="after">
                    <filter name="filter_by_fee_generated" string="Not Fee Generated"
                            domain="[('fee_enable','=',True),('fee_generated','=',False)]"/>
                </field>
            </field>
        </record>

        <!-- for fee bank details in department -->
        <record id="view_odoocms_department_form_inherit" model="ir.ui.view">
            <field name="name">odoocms.department.form.inherit</field>
            <field name="model">odoocms.department</field>
            <field name="inherit_id" ref="odoocms.view_odoocms_department_form"/>
            <field name="arch" type="xml">
                <field name="code" position="after">
                    <field name="account_payable"/>
                    <field name="account_title"/>
                    <field name="account_no"/>
                    <field name="analytic_account_id"
                        options="{'no_quick_create':True, 'no_create_edit': True, 'limit': 10}"/>
                </field>
            </field>
        </record>

        <record id="view_odoocms_program_form" model="ir.ui.view">
            <field name="name">odoocms.program.form</field>
            <field name="model">odoocms.program</field>
            <field name="inherit_id" ref="odoocms_base.view_odoocms_program_form"/>
            <field name="arch" type="xml">
                <field name="code" position="after">
                    <field name="analytic_account_id"
                        options="{'no_quick_create':True, 'no_create_edit': True, 'limit': 10}"/>
                </field>
            </field>
        </record>

        <menuitem
                id="menu_odoocms_fee_students"
                parent="menu_odoocms_student_fee_student_main"
                name="Students"
                action="odoocms.action_odoocms_student"
                sequence="8"/>

    </data>
</odoo>
